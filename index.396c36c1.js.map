{"mappings":"AAAA,MAAMA,EAASC,SAASC,eAAe,UACjCC,EAAMH,EAAOI,WAAW,MACxBC,EAAgBJ,SAASK,cAAc,UAE7C,IAEIC,EACAC,EAHAC,EAAWT,EAAOU,MAClBC,EAAYX,EAAOY,OAGnBC,GAAc,EAElB,MAYMC,EAAcC,UAClB,MAAMC,EAAS,IAAIC,MACnBD,EAAOE,YAAc,YAErBL,GAAc,EAEdG,EAAOG,iBAAiB,QAASC,IAC/BP,GAAc,EACdN,EAAYa,EAAEC,OACd,MAAMC,EAAQN,EAAOJ,OAASI,EAAON,MACrCV,EAAOY,OAASD,EAAYF,EAAWa,EAEvCnB,EAAIoB,UAAUP,EAAQ,EAAG,EAAGP,EAAUT,EAAOY,QAC7CJ,EAAUL,EAAIqB,aAAa,EAAG,EAAGf,EAAUE,EAAU,IAGvDK,EAAOS,SA5BYV,WACnB,IACE,MAAMW,QAAYC,MAChB,iGAGF,aADmBD,EAAIE,QACXC,KAAKC,O,CACjB,MAAOC,GACPC,QAAQC,IAAI,kBAAoBF,E,GAoBfG,EAAc,EAe7BC,EAAcC,IAClB,MAAMC,EAAEA,EAACC,EAAEA,GAAMF,EAAQf,OAAOkB,wBAIhC,MAAO,CAHQH,EAAQI,QAGNH,EAFFD,EAAQK,QAEMH,EAAE,EAGjCtC,EAAOmB,iBAAiB,aAAcuB,IACpC,GAAI7B,EAAa,CACfV,EAAIwC,OACJxC,EAAIyC,UAAU,EAAG,EAAGnC,EAAUE,GAC9BR,EAAI0C,aAAarC,EAAS,EAAG,GAE7B,MAAOsC,EAAMC,EAAMC,GA1BJ,EAACC,EAAK7B,KACvB,MAAO8B,EAAMC,GAAQhB,EAAWf,GAQhC,OANAjB,EAAIiD,UAAY,EAChBjD,EAAIkD,YACJlD,EAAImD,IAAIJ,EAAMC,EAAMF,EAAK,EAAa,EAAVM,KAAKC,IACjCrD,EAAIsD,SACJtD,EAAIuD,OAEG,CAACR,EAAMC,EAAMF,EAAI,EAiBOU,CAAW,GAAIjB,GAK5C,IAAIkB,EAHSd,EAAQtC,EAAQE,MAASH,EAAUG,MAG3BoC,EAAOE,EAAS,EACjCa,EAHSd,EAAQvC,EAAQI,OAAUL,EAAUK,OAG5BmC,EAAOC,EAAS,EAErCY,EAAUA,GAAW,EAAI,EAAIA,EAC7BC,EAAUA,GAAW,EAAI,EAAIA,EAE7B1D,EAAIoB,UACFhB,EACA,EACA,EACAA,EAAUG,MACVH,EAAUK,QACTgD,GACAC,EACDtD,EAAUG,MACVH,EAAUK,QAEZT,EAAI2D,S,KAIRzD,EAAcc,iBAAiB,QAASL,GAExCA","sources":["src/script.js"],"sourcesContent":["const canvas = document.getElementById(\"canvas\");\r\nconst ctx = canvas.getContext(\"2d\");\r\nconst fetchPhotoBtn = document.querySelector(\"button\");\r\n\r\nlet cvsWidth = canvas.width;\r\nlet cvsHeight = canvas.height;\r\nlet originImg;\r\nlet imgData;\r\nlet imgIsLoaded = false;\r\n\r\nconst getRandomImg = async () => {\r\n  try {\r\n    const res = await fetch(\r\n      `https://api.unsplash.com/photos/random/?client_id=${process.env.ACCESS_KEY}`\r\n    );\r\n    const data = await res.json()\r\n    return data.urls.regular\r\n  } catch (error) {\r\n    console.log(\"error happened \" + error)\r\n  }\r\n};\r\n\r\nconst generateImg = async () => {\r\n  const newImg = new Image();\r\n  newImg.crossOrigin = \"Anonymous\";\r\n\r\n  imgIsLoaded = false;\r\n\r\n  newImg.addEventListener(\"load\", (e) => {\r\n    imgIsLoaded = true;\r\n    originImg = e.target;\r\n    const ratio = newImg.height / newImg.width;\r\n    canvas.height = cvsHeight = cvsWidth * ratio;\r\n\r\n    ctx.drawImage(newImg, 0, 0, cvsWidth, canvas.height);\r\n    imgData = ctx.getImageData(0, 0, cvsWidth, cvsHeight);\r\n  });\r\n\r\n  newImg.src = await getRandomImg();\r\n};\r\n\r\nconst drawCircle = (rad, e) => {\r\n  const [posX, posY] = moveCircle(e);\r\n\r\n  ctx.lineWidth = 3;\r\n  ctx.beginPath();\r\n  ctx.arc(posX, posY, rad, 0, Math.PI * 2);\r\n  ctx.stroke();\r\n  ctx.clip();\r\n\r\n  return [posX, posY, rad];\r\n};\r\n\r\nconst moveCircle = (mouseEv) => {\r\n  const { x, y } = mouseEv.target.getBoundingClientRect();\r\n  const mouseX = mouseEv.clientX;\r\n  const mouseY = mouseEv.clientY;\r\n\r\n  return [mouseX - x, mouseY - y];\r\n};\r\n\r\ncanvas.addEventListener(\"mousemove\", (eventObj) => {\r\n  if (imgIsLoaded) {\r\n    ctx.save();\r\n    ctx.clearRect(0, 0, cvsWidth, cvsHeight);\r\n    ctx.putImageData(imgData, 0, 0);\r\n\r\n    const [arcX, arcY, radius] = drawCircle(45, eventObj);\r\n\r\n    const newX = (arcX / imgData.width) * originImg.width;\r\n    const newY = (arcY / imgData.height) * originImg.height;\r\n\r\n    let offsetX = newX - arcX - radius / 2;\r\n    let offsetY = newY - arcY - radius / 2;\r\n\r\n    offsetX = offsetX <= 0 ? 0 : offsetX;\r\n    offsetY = offsetY <= 0 ? 0 : offsetY;\r\n\r\n    ctx.drawImage(\r\n      originImg,\r\n      0,\r\n      0,\r\n      originImg.width,\r\n      originImg.height,\r\n      -offsetX,\r\n      -offsetY,\r\n      originImg.width,\r\n      originImg.height\r\n    );\r\n    ctx.restore();\r\n  }\r\n});\r\n\r\nfetchPhotoBtn.addEventListener(\"click\", generateImg);\r\n\r\ngenerateImg();"],"names":["$2aac3885343dc6b2$var$canvas","document","getElementById","$2aac3885343dc6b2$var$ctx","getContext","$2aac3885343dc6b2$var$fetchPhotoBtn","querySelector","$2aac3885343dc6b2$var$originImg","$2aac3885343dc6b2$var$imgData","$2aac3885343dc6b2$var$cvsWidth","width","$2aac3885343dc6b2$var$cvsHeight","height","$2aac3885343dc6b2$var$imgIsLoaded","$2aac3885343dc6b2$var$generateImg","async","newImg","Image","crossOrigin","addEventListener","e","target","ratio","drawImage","getImageData","src","res","fetch","json","urls","regular","error","console","log","$2aac3885343dc6b2$var$getRandomImg","$2aac3885343dc6b2$var$moveCircle","mouseEv","x","y","getBoundingClientRect","clientX","clientY","eventObj","save","clearRect","putImageData","arcX","arcY","radius","rad","posX","posY","lineWidth","beginPath","arc","Math","PI","stroke","clip","$2aac3885343dc6b2$var$drawCircle","offsetX","offsetY","restore"],"version":3,"file":"index.396c36c1.js.map"}